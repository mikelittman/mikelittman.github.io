<!doctype html>
<html lang="en">
    <head>
        <title>Inventory Manager</title>
        <style>
            html, body{
                height: 100%;
                width: 100%;
                background-color: rgba(200,200,200,.5);
                margin: 0;
                padding: 0;
            }
            .content{
                max-width: 600px;
                margin: auto;
            }
        </style>
    </head>
    <body>
        <div class="content">
            <button id="refreshInventory">Refresh Inventory</button>
            <br>
            <ul class="inventoryList">

            </ul>
        </div>
        <script src="/assets/js/libs/jquery-2.1.3.min.js"></script>
        <script>
            $(function(){
                var makeRequest = function(params){
                    var request = window.location.hash.substr(1) + '?' + JSON.stringify(params);
                    var script = document.createElement('script');
                    script.src = request;
                    document.body.appendChild(script);
                };

                window.invCache = {};

                window.renderItems = function(){
                    var list = $('.inventoryList');

                    list.html('');
                    for(var item in window.invCache.items){
                        list.append(
                            $('<li>').text(item)
                                .attr('uuid', window.invCache.items[item])
                        );
                    }
                };

                window.doThing = function(doc){
                    var request = doc.request;
                    if(request){
                        if(request == "gotInventory"){
                            var items = doc.items;
                            invCache.items = items;
                            window.renderItems();
                        }
                    }
                };

                $('#refreshInventory').click(function(){
                    makeRequest({'request': 'getInventory'});
                });
            });
        </script>
    </body>
</html>
